"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[695],{467:(e,t,r)=>{r.d(t,{ZJ:()=>a,mB:()=>n,qo:()=>d,vV:()=>o,vy:()=>l,wX:()=>s});let i=async()=>"undefined"!=typeof chrome&&chrome.storage?new Promise(e=>{chrome.storage.local.get("apiUrl",t=>{e(t.apiUrl||"https://api.digests.app")})}):"undefined"!=typeof localStorage&&localStorage.getItem("apiUrl")||"https://api.digests.app";async function s(e){if("undefined"!=typeof chrome&&chrome.runtime)return new Promise((t,r)=>{chrome.runtime.sendMessage({action:"fetchRSS",feedUrls:e},e=>{if(chrome.runtime.lastError){r(Error(chrome.runtime.lastError.message));return}if(e.error){r(Error(e.error));return}t(e)})});{let t=await i(),r=await fetch("".concat(t,"/parse"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:e})});if(!r.ok)throw Error("Failed to fetch feeds");let s=await r.json(),a=s.feeds.filter(e=>"ok"===e.status).map(e=>({type:e.type||"",guid:e.guid||"",status:e.status,siteTitle:e.siteTitle,feedTitle:e.feedTitle,feedUrl:e.feedUrl,description:e.description||"",link:e.link||"",lastUpdated:e.lastUpdated||"",lastRefreshed:e.lastRefreshed||new Date().toISOString(),published:e.published||"",author:e.author||null,language:e.language||"",favicon:e.favicon||"",categories:e.categories||"",items:[]})),o=s.items||[];return o.sort((e,t)=>new Date(t.published).getTime()-new Date(e.published).getTime()),{feeds:a,items:o}}}async function a(e){if("undefined"!=typeof chrome&&chrome.runtime)return new Promise((t,r)=>{chrome.runtime.sendMessage({action:"discoverFeeds",discoverUrls:e},e=>{if(chrome.runtime.lastError){r(Error(chrome.runtime.lastError.message));return}if(e.error){r(Error(e.error));return}t(e.feeds.filter(e=>"error"!==e.status).map(e=>({type:e.type||"",guid:e.guid||"",status:e.status||"ok",siteTitle:e.siteTitle||e.title||"",feedTitle:e.feedTitle||e.title||"",feedUrl:e.feedUrl||e.url||"",description:e.description||"",link:e.link||"",lastUpdated:e.lastUpdated||"",lastRefreshed:e.lastRefreshed||new Date().toISOString(),published:e.published||"",author:e.author||null,language:e.language||"",favicon:e.favicon||"",categories:e.categories||"",items:[]})))})});{let t=await i(),r=await fetch("".concat(t,"/discover"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:e})});if(!r.ok)throw Error("Failed to fetch feed details");return(await r.json()).feeds.filter(e=>"error"!==e.status).map(e=>({type:e.type||"",guid:e.guid||"",status:e.status||"ok",siteTitle:e.siteTitle||e.title||"",feedTitle:e.feedTitle||e.title||"",feedUrl:e.feedUrl||e.url||"",description:e.description||"",link:e.link||"",lastUpdated:e.lastUpdated||"",lastRefreshed:e.lastRefreshed||new Date().toISOString(),published:e.published||"",author:e.author||null,language:e.language||"",favicon:e.favicon||"",categories:e.categories||"",items:[]}))}}async function o(e){let t=await i(),r=await fetch("".concat(t,"/reader"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(!r.ok)throw Error("Failed to fetch reader view");return await r.json()}async function n(){if("undefined"!=typeof chrome&&chrome.runtime)return new Promise((e,t)=>{chrome.runtime.sendMessage({action:"fetchBingImage"},r=>{if(chrome.runtime.lastError){t(Error(chrome.runtime.lastError.message));return}if(r.error){t(Error(r.error));return}e({url:URL.createObjectURL(r.imageBlob),title:r.title,copyright:r.copyright})})});try{let e=await fetch("https://www.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1&mkt=en-US");if(!e.ok)throw Error("Failed to fetch Bing image");let t=(await e.json()).images[0];return{url:"https://www.bing.com".concat(t.url.replace(/1920x1080/g,"UHD")),title:t.title,copyright:t.copyright}}catch(e){return console.error("Error fetching Bing image:",e),{url:"/images/default-background.jpg",title:"Default Background",copyright:"\xa9 Calm New Tab"}}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;if(!e)return"";let{r:s,g:a,b:o}=e,n=Math.max(3,t),l=[];for(let e=0;e<n;e++){let t=(e+1)*i,d=r/n*(e+1);l.push("0px 0px ".concat(t,"px rgba(").concat(s,", ").concat(a,", ").concat(o,", ").concat(d,")"))}return l.join(", ")}function d(e){return Math.ceil(e.trim().split(/\s+/).length/183)}},2474:(e,t,r)=>{r.d(t,{$:()=>l});var i=r(4687);r(5924);var s=r(7107),a=r(9700),o=r(3450);let n=(0,a.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:r,size:a,asChild:l=!1,...d}=e,c=l?s.DX:"button";return(0,i.jsx)(c,{"data-slot":"button",className:(0,o.cn)(n({variant:r,size:a,className:t})),...d})}},3450:(e,t,r)=>{r.d(t,{cn:()=>a});var i=r(4930),s=r(764);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,i.$)(t))}},3695:(e,t,r)=>{r.d(t,{ReaderViewProvider:()=>c,S:()=>u});var i=r(4687),s=r(5924),a=r(7308),o=r(2474),n=r(467);function l(e){let{url:t,onClose:r,isOpen:l}=e,[d,c]=(0,s.useState)(null),[u,f]=(0,s.useState)(!0),[h,g]=(0,s.useState)(0),m=(0,s.useRef)(null);return((0,s.useEffect)(()=>{t&&l&&(async()=>{f(!0);try{let e=await (0,n.vV)(t);c(e)}catch(e){console.error("Failed to load article:",e)}finally{f(!1)}})()},[t,l]),(0,s.useEffect)(()=>{let e=()=>{if(!m.current)return;let{scrollTop:e,scrollHeight:t,clientHeight:r}=m.current;g(Math.min(Math.max(0,e/(t-r)*100),100))},t=m.current;if(t)return t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)},[]),l)?(0,i.jsxs)("div",{className:"reader-view-modal fixed inset-0 z-50 bg-black/70 backdrop-blur-xl flex items-center justify-center transition-opacity duration-300",style:{opacity:+!!l},onClick:r,children:[(0,i.jsx)("div",{className:"noise absolute inset-0 bg-[url('/images/noisy-background.jpg')] bg-repeat opacity-5 pointer-events-none"}),(0,i.jsxs)("div",{ref:m,className:"reader-view-content bg-background max-w-4xl max-h-[90vh] overflow-y-auto w-full mx-4 md:mx-auto rounded-lg shadow-xl",onClick:e=>{e.stopPropagation()},children:[(0,i.jsx)(o.$,{variant:"ghost",size:"icon",className:"reader-view-close absolute top-6 right-6 z-10 text-foreground/80 hover:text-foreground",onClick:e=>{e.stopPropagation(),r()},children:(0,i.jsx)(a.A,{size:24})}),u?(0,i.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,i.jsx)("div",{className:"spinner h-12 w-12 rounded-full border-4 border-t-primary animate-spin"})}):d?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"reader-view-header sticky top-0 bg-background/95 backdrop-blur-sm z-10 p-8 pb-4 border-b",children:[(0,i.jsxs)("div",{id:"website-info-placeholder",className:"flex items-center gap-2 mb-2",children:[d.favicon&&(0,i.jsx)("img",{src:d.favicon,alt:"".concat(d.siteName," Favicon"),className:"site-favicon w-5 h-5 rounded"}),(0,i.jsx)("span",{className:"text-sm font-medium",children:d.siteName})]}),(0,i.jsx)("h1",{className:"reader-view-title text-2xl font-bold mb-2",children:d.title}),(0,i.jsxs)("p",{className:"reader-view-reading-time text-sm font-bold opacity-75 mb-3",children:[(0,n.qo)(d.textContent)," minutes"]})]}),(0,i.jsx)("div",{className:"reader-view-article px-8 py-6 prose prose-sm md:prose-base lg:prose-lg dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:d.content}})]}):(0,i.jsx)("div",{className:"p-8",children:(0,i.jsx)("p",{children:"Failed to load article content."})})]}),(0,i.jsx)("div",{className:"progress-indicator-container fixed bottom-6 right-6 w-12 h-12 bg-background/80 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg",children:(0,i.jsxs)("svg",{className:"progress-circle",viewBox:"0 0 36 36",width:"100%",height:"100%",children:[(0,i.jsx)("circle",{className:"progress-circle__background stroke-muted-foreground/20",cx:"18",cy:"18",r:"16",fill:"none",strokeWidth:"2"}),(0,i.jsx)("circle",{className:"progress-circle__progress stroke-primary",cx:"18",cy:"18",r:"16",fill:"none",strokeWidth:"2",strokeDasharray:"100.53",strokeDashoffset:100.53-100.53*h/100,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%",transition:"all 50ms ease-in"}})]})})]}):null}let d=(0,s.createContext)(void 0);function c(e){let{children:t}=e,[r,a]=(0,s.useState)(!1),[o,n]=(0,s.useState)(null),c=(0,s.useCallback)(e=>{n(e),a(!0),"undefined"!=typeof document&&(document.body.style.overflow="hidden")},[]),u=(0,s.useCallback)(()=>{a(!1),"undefined"!=typeof document&&(document.body.style.overflow="")},[]);return(0,i.jsxs)(d.Provider,{value:{openReaderView:c,closeReaderView:u,isReaderViewOpen:r,currentUrl:o},children:[t,o&&(0,i.jsx)(l,{url:o,onClose:u,isOpen:r})]})}function u(){let e=(0,s.useContext)(d);if(void 0===e)throw Error("useReaderView must be used within a ReaderViewProvider");return e}}}]);